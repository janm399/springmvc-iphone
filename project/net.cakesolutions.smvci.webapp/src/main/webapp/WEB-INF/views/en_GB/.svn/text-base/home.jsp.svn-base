<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@ taglib prefix="d" uri="http://uk.co.protomed/tags/display" %>
<%@ taglib prefix="buttons" tagdir="/WEB-INF/tags/buttons/" %>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link type="text/css" rel="stylesheet" href="/styles/main.css" />
	<link type="text/css" rel="stylesheet" href="/styles/effects.css" />
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>
	<script src="http://cdn.jquerytools.org/1.1.2/tiny/jquery.tools.min.js" type="text/javascript"></script>
	<script src="/js/tools.overlay.apple-1.0.1.min.js" type="text/javascript"></script>
	<script src="/js/jquery.jbind-1.5.7.js" type="text/javascript"></script>
	<title>Biodose</title>
</head>
<body>
<%@ include file="/WEB-INF/tags/navigation.tag"%>
<div class="container">
	<form:form action="/home.html" method="get" commandName="patientSearchForm">
		<fieldset title="Patient search">
			<legend>Patient search</legend>
			<p><label for="input">Patient</label><form:input path="term" cssClass="long"/> 
				<input type="submit" value="Search" /> <input type="reset" value="Clear" /></p>
			<p> <span class="input">
					<label for="doctorId"><spring:message code="home.patientSearch.filterByDoctor" /></label>
					<form:select path="doctorId">
						<form:option value="">Any</form:option>
						<c:forEach items="${doctors.page}" var="e">
							<form:option value="${e.id}">${e.title} ${e.firstName} ${e.lastName}</form:option>
						</c:forEach>
					</form:select>
				</span>
				<span class="input">
					<label for="careHomeId"><spring:message code="home.patientSearch.filterByCareHome" /></label>
					<form:select path="careHomeId">
						<form:option value="">Any</form:option>
						<form:options items="${careHomes.page}" itemValue="id" itemLabel="name" />
					</form:select>
				</span>
			</p>
		</fieldset>
	</form:form>
	<div style="clear:both"></div>
	<d:table result="${patients}" uid="p">
		<d:column title="name">${p.title} ${p.firstName} ${p.lastName}</d:column>
		<d:column property="ward"/>
		<d:column property="floor"/>
		<d:column property="room"/>
		<d:column title="Actions">
			<a href="/patient/${p.id}/pic.html">Main</a> |
			<a href="/patient/${p.id}/view/pic.html" rel="#overlay">PIC</a> |
			<a href="/patient/${p.id}/view/mar.html" rel="#overlay">MAR</a> |
			<a href="/patient/${p.id}/view/tray.html" rel="#overlay">Tray</a> |
			<a href="/patient/edit/${p.id}.html">Edit</a> |
			<a href="/patient/${p.id}/view/notes.html" rel="#overlay">Notes</a>
		</d:column>
	</d:table>
</div>
<div class="apple_overlay" id="overlay"> 
	<div style="clear:both;"></div>
	<div class="contentWrap"></div>
	<div style="clear:both;"></div>
</div>
<script type="text/javascript">
$(function() {
    $("a[rel]").overlay({ 
        effect: 'apple', 
        onBeforeLoad: function() { 
            // grab wrapper element inside content 
            var wrap = this.getContent().find(".contentWrap"); 
            // load the page specified in the trigger 
            wrap.load(this.getTrigger().attr("href")); 
        } 
    });
});
</script>
</body>
</html>